<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据分区的策略和工具 | ⚒️Beangle Software</title>
    <meta name="description" content="Beangle provides agile development scaffold and toolkits">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.CKt912cI.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.C0qkNyAQ.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.BOpFTrOg.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CBTkueSR.js">
    <link rel="modulepreload" href="/assets/docs_data_sharding.md.DYiRoL45.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>⚒️Beangle Software</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>🏠Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>📚Documents</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/beangle" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/beangle" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Projects</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/commons/core.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>🧰Commons</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/data.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>📈Data</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/micdn.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>✳️Micdn</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/sas.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>🎡Sas</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/spring.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>⚙️Spring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/webmvc.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>✨WebMVC</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>页面导航</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _docs_data_sharding" data-v-e6f2a212><div><h1 id="数据分区的策略和工具" tabindex="-1">数据分区的策略和工具 <a class="header-anchor" href="#数据分区的策略和工具" aria-label="Permalink to &quot;数据分区的策略和工具&quot;">​</a></h1><h2 id="一-程序显示控制分区策略" tabindex="-1">一 程序显示控制分区策略 <a class="header-anchor" href="#一-程序显示控制分区策略" aria-label="Permalink to &quot;一 程序显示控制分区策略&quot;">​</a></h2><h3 id="_1-1-显式的控制表名" tabindex="-1">1.1 显式的控制表名 <a class="header-anchor" href="#_1-1-显式的控制表名" aria-label="Permalink to &quot;1.1 显式的控制表名&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;select {sgip_mt_log.*} from sgip_mt_log_200610 {sgip_mt_log} where {sgip_mt_log}.MTID=1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">createSQLQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).addEntity(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sgip_mt_log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,classOf[MTMsg]);</span></span></code></pre></div><h2 id="二-客户端配置-对程序透明化" tabindex="-1">二 客户端配置，对程序透明化 <a class="header-anchor" href="#二-客户端配置-对程序透明化" aria-label="Permalink to &quot;二 客户端配置，对程序透明化&quot;">​</a></h2><h3 id="_2-1-使用hibernate拦截器进行自动分表" tabindex="-1">2.1 使用Hibernate拦截器进行自动分表 <a class="header-anchor" href="#_2-1-使用hibernate拦截器进行自动分表" aria-label="Permalink to &quot;2.1 使用Hibernate拦截器进行自动分表&quot;">​</a></h3><p>可以拦截普通的新增、更改、删除、以及Hql。</p><div class="language-scala vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">scala</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hibernate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EmptyInterceptor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TestInterceptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmptyInterceptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onPrepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //这里可以根据当前时间或者外部条件，更改sql中的表名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">configuration.setInterceptor(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TestInterceptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>但是无法拿到参数，因此不能根据参数进行判断.这种方式也不是和好办法。</p><h3 id="_2-2-orm-使用hibernate的shards库" tabindex="-1">2.2 (ORM)使用Hibernate的shards库 <a class="header-anchor" href="#_2-2-orm-使用hibernate的shards库" aria-label="Permalink to &quot;2.2 (ORM)使用Hibernate的shards库&quot;">​</a></h3><p>该项目是在对 Google 财务系统数据 Sharding 过程中诞生的。</p><p>优点：</p><ul><li>标准的 Hibernate 编程模型</li><li>使用ShardConfiguration管理多个数据库连接</li><li>支持简单的Criteria和HQL</li><li>支持分库的ID生成策略</li><li>使用注解进行ID生成策略配置</li><li>相对弹性的 Sharding 策略以及支持虚拟 Shard</li></ul><p>缺点：</p><ul><li>可以使用Criteria,最好没有orderBy</li><li>可以使用HQL,最好没有orderBy以及聚合函数</li></ul><p>参考:</p><ul><li><a href="http://docs.jboss.org/hibernate/stable/shards/reference/en/html_single/" target="_blank" rel="noreferrer">Jboss网站上的文档</a></li><li><a href="http://hibernate.org/others/" target="_blank" rel="noreferrer">Hibernate网站上的介绍</a></li></ul><h3 id="_2-3-orm-国内的支持分表的orm-guzz" tabindex="-1">2.3 (ORM)国内的支持分表的ORM Guzz <a class="header-anchor" href="#_2-3-orm-国内的支持分表的orm-guzz" aria-label="Permalink to &quot;2.3 (ORM)国内的支持分表的ORM Guzz&quot;">​</a></h3><p>Guzz 是一种用来进行快速开发和高性能网站设计的框架，用于替代或者补充hibernate或ibatis的持久化实现，并提供更多的大型系统架构设计 支持。guzz的目标是使得大型化网站设计更加简单，团队分工更加明确，框架在使用时更少出问题。主要设计理念：</p><ul><li>更容易的团队管理和人员分工</li><li>现代大规模系统设计</li><li>支持像hibernate一样的对象持久，映射和方便的增删改查</li><li>支持像ibatis一样，让dba参与sql设计的复杂数据库操作和优化</li><li>支持大量的数据库和主从分离</li><li>支持数据表在多组机器中水平分布（Shard）</li><li>组件化服务（SOA），构建企业基础服务平台</li><li>提高xx%倍效率的快速开发</li><li>支持配置管理服务器，对所有应用程序的配置进行统一管理</li></ul><h3 id="_2-4-cobar-client" tabindex="-1">2.4 Cobar Client <a class="header-anchor" href="#_2-4-cobar-client" aria-label="Permalink to &quot;2.4 Cobar Client&quot;">​</a></h3><p>Cobar Client是一个轻量级分布式数据访问层（DAL）基于iBatis(已更名为MyBatis)和Spring框架实现。</p><p><img src="http://static.oschina.net/uploads/img/201104/27225534_x1rx.png" alt="架构图"></p><p>主要特性：</p><ul><li>可以支持垂直和水平数据切分数据库集群的访问;</li><li>支持双机热备的HA解决方案, 应用方可以根据情况选用数据库特定的HA解决方案(比如Oracle的RAC),或者选用CobarClient提供的HA解决方案.</li><li>小数据量的数据集计(Aggregation), 暂时只支持简单的数据合并.</li><li>数据库本地事务的支持, 目前采用Best Efforts 1PC模式的事务管理.</li><li>数据访问操作相关SQL的记录, 分析等.(可以采用国际站现有Ark解决方案,但CobarClient提供扩展的切入接口)</li></ul><h3 id="_2-5-使用驱动级别的分表工具tddl" tabindex="-1">2.5 使用驱动级别的分表工具TDDL <a class="header-anchor" href="#_2-5-使用驱动级别的分表工具tddl" aria-label="Permalink to &quot;2.5 使用驱动级别的分表工具TDDL&quot;">​</a></h3><p><a href="http://www.oschina.net/p/tddl" target="_blank" rel="noreferrer">Tddl</a>是淘宝的开源产品。整个产品包括对应用透明的分库分表层和具有众多特性的动态数据源。目前仅先开源动态数据源，尚未开源分库分表层部分。</p><p>动态数据源的主要特性有:</p><ol><li>数据库主备和动态切换</li><li>带权重的读写分离</li><li>单线程读重试</li><li>集中式数据源信息管理和动态变更</li><li>剥离的稳定jboss数据源</li><li>支持mysql和oracle数据库</li><li>基于jdbc规范，很容易扩展支持实现jdbc规范的数据源</li><li>无server,client-jar形式存在，应用直连数据库</li><li>读写次数,并发度流控，动态变更</li><li>可分析的日志打印,日志流控，动态变更</li></ol><h3 id="_2-6-dbshards商业jdbc驱动" tabindex="-1">2.6 Dbshards商业jdbc驱动 <a class="header-anchor" href="#_2-6-dbshards商业jdbc驱动" aria-label="Permalink to &quot;2.6 Dbshards商业jdbc驱动&quot;">​</a></h3><p><a href="http://dbshards.com/dbshards/" target="_blank" rel="noreferrer">DbShards</a>是目前国际领先的数据拆分技术。该技术通过数据拆分解决数据库横向扩容的难题，将原来集中存储的数据根据一定的规则分布到不同的物理数据 库服务器上，从而实现数据服务器更快的查询、更多的处理、更高的可靠。使用dbSharads这一性价比极高的技术，您无需再通过提高DB服务器的配置、 增加DB服务器来提高硬件速度的纵向扩容方法来解决访问压力。</p><p><img src="http://dbshards.com/wp-content/uploads/2013/01/dbshards_overview_small-300x180.png" alt="架构图"></p><h2 id="三-使用独立进程的代理进行分区-proxy" tabindex="-1">三 使用独立进程的代理进行分区(Proxy) <a class="header-anchor" href="#三-使用独立进程的代理进行分区-proxy" aria-label="Permalink to &quot;三 使用独立进程的代理进行分区(Proxy)&quot;">​</a></h2><h3 id="_3-1-mysql-proxy-kingshard" tabindex="-1">3.1 Mysql Proxy kingshard <a class="header-anchor" href="#_3-1-mysql-proxy-kingshard" aria-label="Permalink to &quot;3.1 Mysql Proxy kingshard&quot;">​</a></h3><p><a href="http://www.oschina.net/p/kingshard" target="_blank" rel="noreferrer">Kingshard</a> <img alt="推荐" style="height:30px;" src="http://www.oschina.net/img/recomm.gif">是一个由Go开发高性能MySQL Proxy项目，kingshard在满足基本的读写分离的功能上，致力于简化MySQL分库分表操作；能够让DBA通过kingshard轻松平滑地实现MySQL数据库扩容。 主要功能：</p><ul><li>读写分离。</li><li>跨节点分表。</li><li>客户端IP访问控制。</li><li>平滑上线DB或下线DB，前端应用无感知。</li></ul><h3 id="_3-2-mysql-proxy-spock" tabindex="-1">3.2 Mysql Proxy Spock <a class="header-anchor" href="#_3-2-mysql-proxy-spock" aria-label="Permalink to &quot;3.2 Mysql Proxy Spock&quot;">​</a></h3><p><a href="http://spockproxy.sourceforge.net/" target="_blank" rel="noreferrer">Spock Proxy</a>是由实际项目产生的一个开源项目（Spock是Rails的应用，Speck Proxy应当可用于Rails之外的，例如PHP或.NET），基于MySQL Proxy开发，是MySQL Proxy的一个分支，支持range-based horizontal paritioning，他对MySQL Proxy所做的改进包括：</p><p>a). 不使用LUA脚本，提升性能。例如将多个数据源返回的结果集合并期间还要与LUA脚本交互，这样的性能开销比较大 b). 客户端登录验证。MySQL Proxy支持客户端与各个服务器直接进行登录验证，Spock Proxy则将其统一管理，分离客户端与服务器的连接 c). 动态连接池。受益于客户端登录认证机制的改善</p><p><img src="http://www.oschina.net/uploads/img/201002/03062346_YmnG.png" alt="架构图"></p><h3 id="_3-3-pl-proxy" tabindex="-1">3.3 PL/Proxy <a class="header-anchor" href="#_3-3-pl-proxy" aria-label="Permalink to &quot;3.3 PL/Proxy&quot;">​</a></h3><p><a href="http://www.oschina.net/p/pl+proxy" target="_blank" rel="noreferrer">PL/Proxy</a><img alt="推荐" style="height:30px;" src="http://www.oschina.net/img/recomm.gif">则是针对 PostgreSQL 的，设计思想类似 Teradata 的 Hash 机制，数据存储对客户端是透明的，客户请求发送到 PL/Proxy 后，由这里分布式存储过程调用，统一分发。 PL/Proxy 的设计初衷就是在这一层充当&quot;数据总线&quot;的职责，所以，当数据吞吐量支撑不住的时候，只需要增加更多的 PL/Proxy 服务器即可。大名鼎鼎的 Skype 用的就是 PL/Proxy 的解决方案。</p><p><img src="http://tse1.mm.bing.net/th?&amp;id=OIP.M125a49c7ff4d68d23ef91c9c0a5bee88o0&amp;w=300&amp;h=300&amp;c=0&amp;pid=1.9&amp;rs=0&amp;p=0" alt="架构图"></p><h1 id="四-其他资料" tabindex="-1">四 其他资料 <a class="header-anchor" href="#四-其他资料" aria-label="Permalink to &quot;四 其他资料&quot;">​</a></h1><ul><li><a href="http://blog.csdn.net/qingrx/article/details/8756839" target="_blank" rel="noreferrer">CSDN 上的一篇不错的综合介绍</a></li><li><a href="http://wiki.postgresql.org/images/0/00/2011.10_Digoal.Zhou_PostgreSQL_PLProxy%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5.pdf" target="_blank" rel="noreferrer">国人介绍PL/Proxy的pdf</a></li><li><a href="http://my.oschina.net/u/142836/blog/174465" target="_blank" rel="noreferrer">Mysql下全局ID生成策略Flicker</a></li><li><a href="http://blog.csdn.net/czp11210/article/details/23429001" target="_blank" rel="noreferrer">淘宝TDDL的剖析</a></li><li><a href="http://www.postgres-xl.org/overview/" target="_blank" rel="noreferrer">PostgreSQL群集软件PostgreSQL-XL</a></li><li><a href="http://instagram-engineering.tumblr.com/post/10853187575/sharding-ids-at-instagram" target="_blank" rel="noreferrer">Instagram的ID生成策略</a></li><li><a href="https://github.com/citusdata/pg_shard" target="_blank" rel="noreferrer">Postgresql扩展PG_Shard</a></li><li><a href="https://github.com/hubinix/kamike.divide" target="_blank" rel="noreferrer">仿照TDDL写的分区程序Kamike</a></li><li><a href="http://shanchao7932297.blog.163.com/blog/static/136362420114250740984/" target="_blank" rel="noreferrer">如何安装GridSql</a></li><li><a href="http://topic.csdn.net/u/20090416/21/8629c72a-857a-487b-ae1b-3db31cfd850b.html" target="_blank" rel="noreferrer">对比pgpool, GridSQL和plproxy三种集群方案</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><!----></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/docs/commons/core.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>🧰Commons</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"docs_commons_core.md\":\"BVRH-7Kh\",\"docs_commons_index.md\":\"DLCWS3Q0\",\"docs_commons_release-4.1.0.md\":\"D-2fJs71\",\"docs_data_hibernate.md\":\"CF4WylEb\",\"docs_data_index.md\":\"xELfP3OB\",\"docs_data_mapping.md\":\"0JEVZOB6\",\"docs_data_sharding.md\":\"DYiRoL45\",\"docs_data_transport.md\":\"CcgIum5d\",\"docs_index.md\":\"AjuoJfZY\",\"docs_micdn_index.md\":\"ByQx4tpS\",\"docs_sas_index.md\":\"O1Lr_Ife\",\"docs_sas_lightwar.md\":\"DlvP8uks\",\"docs_spring_binding.md\":\"DvCm9hUt\",\"docs_spring_hibernate.md\":\"Bb9W1TwB\",\"docs_spring_index.md\":\"BwoywXQa\",\"docs_spring_reconfig.md\":\"DVXkJFie\",\"docs_webmvc_index.md\":\"C9xxKBLL\",\"docs_webmvc_tags.md\":\"BaKGZ6t-\",\"docs_webmvc_usage.md\":\"CHIbggDQ\",\"index.md\":\"Bmqlh8v_\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"⚒️Beangle Software\",\"description\":\"Beangle provides agile development scaffold and toolkits\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"🏠Home\",\"link\":\"/\"},{\"text\":\"📚Documents\",\"link\":\"/docs\"}],\"outline\":{\"label\":\"页面导航\",\"level\":[2,6]},\"sidebar\":[{\"text\":\"Projects\",\"items\":[{\"text\":\"🧰Commons\",\"link\":\"/docs/commons/core\"},{\"text\":\"📈Data\",\"link\":\"/docs/data\"},{\"text\":\"✳️Micdn\",\"link\":\"/docs/micdn\"},{\"text\":\"🎡Sas\",\"link\":\"/docs/sas\"},{\"text\":\"⚙️Spring\",\"link\":\"/docs/spring\"},{\"text\":\"✨WebMVC\",\"link\":\"/docs/webmvc\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/beangle\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>